---
title: 【Next】创建项目
date: 2024-02-18
sidebar: 'auto'
categories:
 - Next
tags:
 - Next
publish: true
---
## 前言
一起学习Next.js。引用官网一句话 `The React Framework for the Web
Used by some of the world's largest companies, Next.js enables you to create high-quality web applications with the power of React components.`这是一个用于 生产环境的
React 框架
Next.js 为您提供生产环境所需的所有功能以及最佳的开发体验：包括静态及服务器端融合渲染、 支持 TypeScript、智能化打包、 路由预取等功能 无需任何配置。  
[中文官网](https://www.nextjs.cn/)      
[英文官网](https://nextjs.org/)
::: tip
node版本v18.17.1   
Next版本v14.1
:::

## 创建项目
### 自动创建
官方推荐使用脚手架[create-next-app](https://www.nextjs.cn/docs/api-reference/create-next-app)
```shell
npx create-next-app@latest
#或者
yarn create-next-app

#如果使用ts
npx create-next-app@latest --ts
#或者
yarn create-next-app --typescript
```
<img :src="$withBase('/imgs/0_2_NextJS/autoBuild.jpg')" alt=""><br/>
等待依赖安装完成，打开文件目录`cd my-app`，

<img :src="$withBase('/imgs/0_2_NextJS/file.jpg')" alt=""><br/>
运行命令`npm run dev`,

<img :src="$withBase('/imgs/0_2_NextJS/runCli.jpg')" alt=""><br/>
打开链接`http://localhost:3000/`

<img :src="$withBase('/imgs/0_2_NextJS/run.jpg')" alt=""><br/>
### 手动创建
大多数时候并不需要手动创建，有时候我们想指定react版本，则需要手动创建项目。
#### 创建目录，安装依赖
```shell
mkdir manual-app
cd manual-app
npm install next@latest react@latest react-dom@latest
```
<img :src="$withBase('/imgs/0_2_NextJS/manual1.jpg')" alt=""><br/>
#### 添加名称
在`package.json`中添加运行打包命令       
```json
{
  "dependencies": {
    "next": "^14.1.0",
    "react": "^18.2.0",
    "react-dom": "^18.2.0"
  },
  "scripts": {
    "dev": "next dev",
    "build": "next build",
    "start": "next start",
    "lint": "next lint",
    "help": "next -h"
  }
}
```
#### 创建文件
在根目录下创建app目录，在里面添加`layout.jsx`
```jsx
export default function Layout({children}) {
	return (
		<html lang="en">
			<body>{children}</body>
		</html>
	);
}

```
`page.jsx`
```jsx
export default function Page() {
	return <h1>你好，Next.js</h1>;
}
```
#### 运行项目
运行项目`npm run dev`，打开网址，出现如下展示，则表示成功
<img :src="$withBase('/imgs/0_2_NextJS/manual2.jpg')" alt=""><br/>

## Cli
根据上面我们知道`npm run dev`其实运行的是`next dev`，这是Next.js Cli中的命令。
我们可以使用`npx next -h`查看所有的命令。ps：因为我们没有全局安装`create-next-app`所以需要使用上面的命令。当然我们也可以使用`npm run help`，因为上面的`package.json`中已经添加命令。
### npm run help
```shell
npm run help
#or
npx next -h
```
看到如下图所示
<img :src="$withBase('/imgs/0_2_NextJS/allcli.jpg')" alt=""><br/>

### npm run build
执行`npm run build`将会创建项目的生产优化版本
```shell
npm run build
#or
npx next build
```
看到如下图所示

<img :src="$withBase('/imgs/0_2_NextJS/build.jpg')" alt=""><br/>
如上图所示，会显示所有的路由信息，且还会有size和first load js。官方文档中介绍      
+ size：导航到该路由时下载的资源大小，意味着目标路由单独依赖的js大小
+ first load js：加载页面时下载的资源大小，我们知道加载页面时需要每个路由都需要依赖的公共js，以及目标路由单独依赖的js
+ first load js shared by all：所有路由共享的js大小
所以由上面可以得出 `first load js = size + first load js shared by all`。   
官方说`first load js`的颜色代表不同的性能，其中绿色代表高性能，红色或者黄色则需要优化。ps：不同的shell工具展示的颜色不同。    